{"version":3,"file":"createInstantSearchComponent.js","sources":["../../../../src/util/createInstantSearchComponent.js"],"sourcesContent":["import { createSuitMixin } from '../mixins/suit';\nimport { version } from '../../package.json'; // rollup does pick only what needed from json\nimport { _objectSpread } from './polyfills';\nimport { isVue3, version as vueVersion } from './vue-compat';\n\nexport const createInstantSearchComponent = component =>\n  _objectSpread(\n    {\n      mixins: [createSuitMixin({ name: 'InstantSearch' })],\n      provide() {\n        return {\n          $_ais_instantSearchInstance: this.instantSearchInstance,\n        };\n      },\n      watch: {\n        searchClient(searchClient) {\n          this.instantSearchInstance.helper.setClient(searchClient).search();\n        },\n        indexName(indexName) {\n          this.instantSearchInstance.helper.setIndex(indexName).search();\n        },\n        stalledSearchDelay(stalledSearchDelay) {\n          // private InstantSearch.js API:\n          this.instantSearchInstance._stalledSearchDelay = stalledSearchDelay;\n        },\n        routing() {\n          throw new Error(\n            'routing configuration can not be changed dynamically at this point.' +\n              '\\n\\n' +\n              'Please open a new issue: https://github.com/algolia/vue-instantsearch/issues/new?template=feature.md'\n          );\n        },\n        searchFunction(searchFunction) {\n          // private InstantSearch.js API:\n          this.instantSearchInstance._searchFunction = searchFunction;\n        },\n        middlewares: {\n          immediate: true,\n          handler(next, prev) {\n            (prev || [])\n              .filter(middleware => (next || []).indexOf(middleware) === -1)\n              .forEach(middlewareToRemove => {\n                this.instantSearchInstance.unuse(middlewareToRemove);\n              });\n\n            (next || [])\n              .filter(middleware => (prev || []).indexOf(middleware) === -1)\n              .forEach(middlewareToAdd => {\n                this.instantSearchInstance.use(middlewareToAdd);\n              });\n          },\n        },\n      },\n      created() {\n        const searchClient = this.instantSearchInstance.client;\n        if (typeof searchClient.addAlgoliaAgent === 'function') {\n          searchClient.addAlgoliaAgent(`Vue (${vueVersion})`);\n          searchClient.addAlgoliaAgent(`Vue InstantSearch (${version})`);\n        }\n      },\n      mounted() {\n        // from the documentation: https://vuejs.org/v2/api/#mounted\n        // \"Note that mounted does not guarantee that all child components have also been mounted. If you want to\n        // wait until the entire view has been rendered, you can use vm.$nextTick inside of mounted\"\n        this.$nextTick(() => {\n          if (!this.instantSearchInstance.started) {\n            this.instantSearchInstance.start();\n          }\n        });\n      },\n      [isVue3 ? 'beforeUnmount' : 'beforeDestroy']() {\n        if (this.instantSearchInstance.started) {\n          this.instantSearchInstance.dispose();\n        }\n\n        // a hydrated instance will no longer be hydrated once disposed, and starts from scratch\n        this.instantSearchInstance.__initialSearchResults = undefined;\n      },\n    },\n    component\n  );\n"],"names":["createInstantSearchComponent","component","_objectSpread","mixins","createSuitMixin","name","provide","$_ais_instantSearchInstance","this","instantSearchInstance","watch","searchClient","helper","setClient","search","indexName","setIndex","stalledSearchDelay","_stalledSearchDelay","routing","Error","searchFunction","_searchFunction","middlewares","immediate","handler","next","prev","filter","middleware","indexOf","forEach","middlewareToRemove","unuse","middlewareToAdd","use","created","client","addAlgoliaAgent","vueVersion","version","mounted","$nextTick","started","start","dispose","__initialSearchResults","undefined"],"mappings":"4MAKaA,WAA+BC,gBAC1CC,MACE,CACEC,OAAQ,CAACC,EAAgB,CAAEC,KAAM,mBACjCC,yBACS,CACLC,4BAA6BC,KAAKC,wBAGtCC,MAAO,CACLC,sBAAaA,QACNF,sBAAsBG,OAAOC,UAAUF,GAAcG,UAE5DC,mBAAUA,QACHN,sBAAsBG,OAAOI,SAASD,GAAWD,UAExDG,4BAAmBA,QAEZR,sBAAsBS,oBAAsBD,GAEnDE,yBACQ,IAAIC,MACR,gLAKJC,wBAAeA,QAERZ,sBAAsBa,gBAAkBD,GAE/CE,YAAa,CACXC,WAAW,EACXC,iBAAQC,EAAMC,eACXA,GAAQ,IACNC,gBAAOC,UAAoD,KAArCH,GAAQ,IAAII,QAAQD,KAC1CE,iBAAQC,GACPxB,EAAKC,sBAAsBwB,MAAMD,MAGpCN,GAAQ,IACNE,gBAAOC,UAAoD,KAArCF,GAAQ,IAAIG,QAAQD,KAC1CE,iBAAQG,GACP1B,EAAKC,sBAAsB0B,IAAID,QAKzCE,uBACQzB,EAAeH,KAAKC,sBAAsB4B,OACJ,mBAAjC1B,EAAa2B,kBACtB3B,EAAa2B,wBAAwBC,OACrC5B,EAAa2B,sCAAsCE,SAGvDC,mCAIOC,qBACElC,EAAKC,sBAAsBkC,SAC9BnC,EAAKC,sBAAsBmC,aAIjC,yBACMpC,KAAKC,sBAAsBkC,cACxBlC,sBAAsBoC,eAIxBpC,sBAAsBqC,4BAAyBC,MAGxD9C"}